!function(){function t(){r.call(this)}function e(t){if(r.call(this),t instanceof n==!1)throw new Error("Invalid config");if(!t.dataProvider)throw new Error("You must specify a data provider");this.contexts={},this.config=t,this.dataProvider=this.config.dataProvider,this.name=this.config.name}function n(e){if(!e.name)throw new Error("Invalid resource name");if(e.dataProvider instanceof t==!1)throw new Error("Invalid data provider");B.extend(this,e)}function r(){r.init.call(this)}function i(t,e){var n={seen:[],stylize:o};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(e)?n.showHidden=e:e&&B._extend(n,e),P(n.showHidden)&&(n.showHidden=!1),P(n.depth)&&(n.depth=2),P(n.colors)&&(n.colors=!1),P(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),u(n,t,n.depth)}function s(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function o(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function u(t,e,n){if(t.customInspect&&e&&x(e.inspect)&&e.inspect!==B.inspect&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(n,t);return _(r)||(r=u(t,r,n)),r}var i=c(t,e);if(i)return i;var s=Object.keys(e),o=a(s);t.showHidden&&(s=Object.getOwnPropertyNames(e));var m,v=e;try{S(e)||(v=e.valueOf())}catch(b){}if(_(v)&&(s=s.filter(function(t){return!(t>=0&&t<v.length)})),0===s.length){if(x(e)){var P=e.name?": "+e.name:"";return t.stylize("[Function"+P+"]","special")}if(w(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(S(e))return t.stylize(Date.prototype.toString.call(e),"date");if(O(e))return l(e);if(_(v))return m=h(t,v),t.stylize("[String: "+m+"]","string");if(y(v))return m=h(t,v),t.stylize("[Number: "+m+"]","number");if(d(v))return m=h(t,v),t.stylize("[Boolean: "+m+"]","boolean")}var E="",L=!1,N=["{","}"];if(G(e)&&(L=!0,N=["[","]"]),x(e)){var j=e.name?": "+e.name:"";E=" [Function"+j+"]"}if(w(e)&&(E=" "+RegExp.prototype.toString.call(e)),S(e)&&(E=" "+Date.prototype.toUTCString.call(e)),O(e)&&(E=" "+l(e)),_(v)&&(m=h(t,v),E=" [String: "+m+"]"),y(v)&&(m=h(t,v),E=" [Number: "+m+"]"),d(v)&&(m=h(t,v),E=" [Boolean: "+m+"]"),0===s.length&&(!L||0===e.length))return N[0]+E+N[1];if(0>n)return w(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var z;return z=L?f(t,e,n,o,s):s.map(function(r){return g(t,e,n,o,r,L)}),t.seen.pop(),p(z,E,N)}function c(t,e){if(P(e))return t.stylize("undefined","undefined");if(_(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?0===e&&0>1/e?t.stylize("-0","number"):t.stylize(""+e,"number"):d(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):b(e)?t.stylize(e.toString(),"symbol"):void 0}function h(t,e){var n=t.stylize;t.stylize=o;var r=c(t,e);return t.stylize=n,r}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,i){for(var s=[],o=0,a=e.length;a>o;++o)D(e,String(o))?s.push(g(t,e,n,r,String(o),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(g(t,e,n,r,i,!0))}),s}function g(t,e,n,r,i,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),D(r,i)||(o="["+i+"]"),a||(t.seen.indexOf(c.value)<0?(a=m(n)?u(t,c.value,null):u(t,c.value,n-1),a.indexOf("\n")>-1&&(a=s?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),P(o)){if(s&&i.match(/^\d+$/))return a;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'").replace(/\\\\/g,"\\"),o=t.stylize(o,"string"))}return o+": "+a}function p(t,e,n){var r=t.reduce(function(t,e){return t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return"boolean"==typeof t}function m(t){return null===t}function v(t){return null==t}function y(t){return"number"==typeof t}function _(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function P(t){return void 0===t}function w(t){return E(t)&&"[object RegExp]"===j(t)}function E(t){return"object"==typeof t&&null!==t}function S(t){return E(t)&&"[object Date]"===j(t)}function O(t){return E(t)&&("[object Error]"===j(t)||t instanceof Error)}function x(t){return"function"==typeof t}function L(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function N(t){return t instanceof Buffer}function j(t){return Object.prototype.toString.call(t)}function z(t){return 10>t?"0"+t.toString(10):t.toString(10)}function A(){var t=new Date,e=[z(t.getHours()),z(t.getMinutes()),z(t.getSeconds())].join(":");return[t.getDate(),q[t.getMonth()],e].join(" ")}function D(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function I(t){r.call(this);var e=I.createQuery();return this.name=t,this.data=null,this.error=null,this.query=e,e.on("update",function(t){this.emit("update")}.bind(this)),this}function U(){function t(){this.emit("update")}C.call(this);var e=t.bind(this);this._filter.on("update",e),this._sorting.on("update",e),this._pagination.on("update",e)}function C(t){r.call(this),this._filter=new F,this._sorting=new M,this._pagination=new J,this.resourceName=t||null}function F(){r.call(this),this._filters=[],this.operatorsArray=Object.keys(this.operators).map(function(t){return this.operators[t]},this)}function J(){r.call(this),this.on("update",function(){}),this.on("pageChanged",function(t,e){1===t&&this.emit("pageFirst"),t>e?this.emit("pageNext"):e>t&&this.emit("pagePrevious"),t===this.totalPages&&this.emit("pageLast")}),this.reset()}function M(){r.call(this),this._sorting=[]}B.inherits(t,r,{find:B.missing("find"),findOne:B.missing("find")}),B.inherits(e,r,{hasContext:function(t){return this.contexts[t]instanceof I},createContext:function(t){if(!this.hasContext(t)){var e=new I(t);e.on("update",function(){this.updateContext(e)}.bind(this)),this.contexts[t]=e}return this.getContext(t)},getContext:function(t){return this.contexts[t]},updateContext:function(t){var e=t.toJSON();return this.dataProvider.find(this.name,e).then(function(e){t.setData(e)},function(e){t.setError(e)}),this},find:function(t){if(t instanceof C==!1)throw new Error("Invalid query builder");var e=t.toJSON();return this.dataProvider.find(this.name,e)}}),r.EventEmitter=r,r.usingDomains=!1,r.prototype.domain=void 0,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.init=function(){this.domain=null,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events={}),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(t){if(!B.isNumber(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,i,s,o;if(this._events||(this._events={}),"error"===t&&!this._events.error){if(e=arguments[1],!this.domain)throw e instanceof Error?e:Error('Uncaught, unspecified "error" event.');return e||(e=new Error('Uncaught, unspecified "error" event.')),e.domainEmitter=this,e.domain=this.domain,e.domainThrown=!1,this.domain.emit("error",e),!1}if(n=this._events[t],B.isUndefined(n))return!1;if(this.domain&&this!==Q&&this.domain.enter(),B.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),s=1;r>s;s++)i[s-1]=arguments[s];n.apply(this,i)}else if(B.isObject(n)){for(r=arguments.length,i=new Array(r-1),s=1;r>s;s++)i[s-1]=arguments[s];for(o=n.slice(),r=o.length,s=0;r>s;s++)o[s].apply(this,i)}return this.domain&&this!==Q&&this.domain.exit(),!0},r.prototype.addListener=function(t,e){var n;if(!B.isFunction(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,B.isFunction(e.listener)?e.listener:e),this._events[t]?B.isObject(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,B.isObject(this._events[t])&&!this._events[t].warned){var n;n=B.isUndefined(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d %s listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length,t),console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!B.isFunction(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},r.prototype.removeListener=function(t,e){var n,r,i,s;if(!B.isFunction(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],i=n.length,r=-1,n===e||B.isFunction(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(B.isObject(n)){for(s=i;s-->0;)if(n[s]===e||n[s].listener&&n[s].listener===e){r=s;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],B.isFunction(n))this.removeListener(t,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?B.isFunction(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?B.isFunction(t._events[e])?1:t._events[e].length:0},angular.module("repository",[]).factory("Repository",function(){return e}).factory("DataProvider",function(){return t}).factory("RepositoryConfig",function(){return n}).factory("QueryBuilder",function(){return C}).factory("QueryFilter",function(){return F}).factory("QueryPagination",function(){return J}).factory("QuerySorting",function(){return M}).factory("Context",function(){return I}).factory("ContextQueryBuilder",function(){return U});var B={},Q={noDeprecation:!0,env:{NODE_DEBUG:1}},R={process:Q};B.missing=function(t){return function(){throw new Error("Method "+t+" not implemented")}},B.toArray=function(t){return Array.prototype.slice.apply(t)};var T=/%[sdj%]/g;B.format=function(t){if(!_(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,s=r.length,o=String(t).replace(T,function(t){if("%%"===t)return"%";if(n>=s)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}}),a=r[n];s>n;a=r[++n])o+=m(a)||!E(a)?" "+a:" "+i(a);return o},B.deprecate=function(t,e){function n(){if(!r){if(Q.throwDeprecation)throw new Error(e);Q.traceDeprecation?console.trace(e):console.error(e),r=!0}return t.apply(this,arguments)}if(P(R.process))return function(){return B.deprecate(t,e).apply(this,arguments)};if(Q.noDeprecation===!0)return t;var r=!1;return n};var k,V={};B.debuglog=function(t){if(P(k)&&(k=Q.env.NODE_DEBUG||""),t=t.toUpperCase(),!V[t])if(new RegExp("\\b"+t+"\\b","i").test(k)){var e=Q.pid;V[t]=function(){var n=B.format.apply(B,arguments);console.error("%s %d: %s",t,e,n)}}else V[t]=function(){};return V[t]},B.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",symbol:"green",date:"magenta",regexp:"red"};var G=B.isArray=Array.isArray;B.isBoolean=d,B.isNull=m,B.isNullOrUndefined=v,B.isNumber=y,B.isString=_,B.isSymbol=b,B.isUndefined=P,B.isRegExp=w,B.isObject=E,B.isDate=S,B.isError=O,B.isFunction=x,B.isPrimitive=L,B.isBuffer=N;var q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];B.log=function(){console.log("%s - %s",A(),B.format.apply(B,arguments))},B.inherits=function(t,e,n){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),E(n)&&B.extend(t.prototype,n)},B._extend=function(t,e){if(!e||!E(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t},B.extend=B._extend,B.p=B.deprecate(function(){for(var t=0,e=arguments.length;e>t;++t)console.error(B.inspect(arguments[t]))},"util.p: Use console.error() instead"),B.print=B.deprecate(function(){for(var t=0,e=arguments.length;e>t;++t)Q.stdout.write(String(arguments[t]))},"util.print: Use console.log instead"),B.puts=B.deprecate(function(){for(var t=0,e=arguments.length;e>t;++t)Q.stdout.write(arguments[t]+"\n")},"util.puts: Use console.log instead"),B.debug=B.deprecate(function(t){Q.stderr.write("DEBUG: "+t+"\n")},"util.debug: Use console.error instead"),B.error=B.deprecate(function(t){for(var e=0,n=arguments.length;n>e;++e)Q.stderr.write(arguments[e]+"\n")},"util.error: Use console.error instead"),B.pump=B.deprecate(function(t,e,n){function r(t,e,r){n&&!i&&(n(t,e,r),i=!0)}var i=!1;t.addListener("data",function(n){e.write(n)===!1&&t.pause()}),e.addListener("drain",function(){t.resume()}),t.addListener("end",function(){e.end()}),t.addListener("close",function(){r()}),t.addListener("error",function(t){e.end(),r(t)}),e.addListener("error",function(e){t.destroy(),r(e)})},"util.pump(): Use readableStream.pipe() instead");var $;B._errnoException=function(t,e,n){P($)&&($=Q.binding("uv"));var r=$.errname(t),i=e+" "+r;n&&(i+=" "+n);var s=new Error(i);return s.code=r,s.errno=r,s.syscall=e,s},I.createQuery=function(){return new U},B.inherits(I,r,{INVALID_RESPONSE:"INVALID_RESPONSE",getData:function(){return this.data},setData:function(t){if(B.isUndefined(t)||!B.isObject(t))return this.setError(this.INVALID_RESPONSE),this;var e=t.meta;if(e){var n=this.query.pagination();n.setState({totalItems:e.totalItems,currentPage:e.currentPage,itemsPerPage:e.itemsPerPage})}return this.data=t.data||null,this.error=null,this},createQuery:function(){return I.createQuery().from(this.name)},pagination:function(){return this.query.pagination()},reset:function(){return this.query.reset(),this},update:function(){return this.triggerUpdate(this),this},triggerUpdate:function(){return this.emit("update")},setError:function(t){},toJSON:function(){return this.query.toJSON()}}),B.inherits(U,C),B.inherits(C,r,{from:function(t){return this.resourceName=t,this},where:function(){return this._filter.where.apply(this._filter,arguments),this},orderBy:function(){return this._sorting.sort.apply(this._sorting,arguments),this},pagination:function(){return this._pagination},toJSON:function(){return{filters:this._filter.toJSON(),pagination:this._pagination.toJSON(),sorting:this._sorting.toJSON()}},reset:function(){return this._filter.reset(),this._sorting.reset(),this._pagination.reset(),this}}),B.extend(C,F.prototype.operators),F.create=function(t){var e=new F;return e.setState(t),e},B.inherits(F,r,{reset:function(){this._filters=[]},where:function(t,e,n){return 2===arguments.length&&(n=e,e=this.operators.EQ),this.hasOperator(e)?(this.addFilter(t,e,n),this):this},hasOperator:function(t){return this.operatorsArray.indexOf(t)>-1},remove:function(t){return t?(this._filters.forEach(function(e,n){e.name===t&&this._filters.splice(n,1)},this),this):this},addFilter:function(){var t,e=B.toArray(arguments);if(B.isArray(e[0])&&(e=e[0]),B.isObject(e[0])&&(t=e[0]),B.isUndefined(t)&&(t={name:e[0],operator:e[1],value:e[2]}),!t)return this;var n=this._filters.some(function(e){return e.name===t.name&&e.operator===t.operator});return n?this:(this._filters.push(t),this)},addFilters:function(t){if(!B.isArray(t))throw new Error("Must be an array");return t.forEach(this.addFilter,this),this},operators:{EQ:"=",LT:"<",LTE:"<=",GT:">",GTE:">=",IN:"in",ST:"^",END:"$",LK:"~"},setState:function(){return this.addFilter.apply(this,arguments)},toJSON:function(){return this._filters.slice()}}),B.inherits(J,r,{isValidPage:function(t){return t>0&&t<=this.totalPages},next:function(){return this.isValidPage(this.currentPage+1)?(this.setPage(this.currentPage+1),this):this},previous:function(){return this.isValidPage(this.currentPage-1)?(this.setPage(this.currentPage-1),this):this},setPage:function(t){var e=this.currentPage;return this.currentPage=t,this.emit("pageChanged",t,e),this.emit("update"),this},setState:function(t){var e=t.totalItems;if(0!==e&&!B.isUndefined(e)&&isNaN(e))throw new Error("Invalid total items property");return angular.extend(this,t),this.refresh(),this},refresh:function(){(this.currentPage<1||!this.isValidPage(this.currentPage))&&(this.currentPage=this.defaults.currentPage),this.itemsPerPage<1&&(this.itemsPerPage=Math.floor(this.defaults.itemsPerPage)),this.totalItems=this.totalItems||0,this.itemsPerPage=parseInt(this.itemsPerPage),this.totalPages=Math.round(this.totalItems/this.itemsPerPage),this.totalPagesArray=[];for(var t=0;t<this.totalPages.length;t++)this.totalPagesArray.push(t+1)},reset:function(){return this.setState({currentPage:0,itemsPerPage:0,totalItems:0,totalPages:0}),this},last:function(){return this.isValidPage(this.totalPages)?(this.setPage(this.totalPages),this):this},first:function(){return this.currentPage?this.setPage(1):this},toJSON:function(){var t={},e=["itemsPerPage","currentPage","count"];return angular.forEach(e,function(e){angular.isDefined(this[e])&&(t[e]=this[e])},this),t},defaults:{itemsPerPage:4,currentPage:1,totalItems:0}}),B.inherits(M,r,{directions:{ASC:"asc",DESC:"desc"},sort:function(t,e){1===arguments.length&&(e=this.directions.ASC);var n={name:t,direction:e};return this.addSorting(n),this},hasSorting:function(t){return this._sorting.some(function(e){return e.name===t})},addSorting:function(t){return this.hasSorting(t.name)&&this._sorting.push(t),this},reset:function(){return this._sorting=[],this},toJSON:function(){return this._sorting.slice()}})}();
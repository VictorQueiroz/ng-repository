!function(){"use strict";function t(t,n){var s={seen:[],stylize:r};return arguments.length>=3&&(s.depth=arguments[2]),arguments.length>=4&&(s.colors=arguments[3]),l(n)?s.showHidden=n:n&&B._extend(s,n),v(s.showHidden)&&(s.showHidden=!1),v(s.depth)&&(s.depth=2),v(s.colors)&&(s.colors=!1),v(s.customInspect)&&(s.customInspect=!0),s.colors&&(s.stylize=e),i(s,t,s.depth)}function e(e,r){var n=t.styles[r];return n?"["+t.colors[n][0]+"m"+e+"["+t.colors[n][1]+"m":e}function r(t,e){return t}function n(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}function i(t,e,r){if(t.customInspect&&e&&w(e.inspect)&&e.inspect!==B.inspect&&(!e.constructor||e.constructor.prototype!==e)){var f=e.inspect(r,t);return d(f)||(f=i(t,f,r)),f}var g=s(t,e);if(g)return g;var m=Object.keys(e),v=n(m);t.showHidden&&(m=Object.getOwnPropertyNames(e));var _,E=e;try{b(e)||(E=e.valueOf())}catch(S){}if(d(E)&&(m=m.filter(function(t){return!(t>=0&&t<E.length)})),0===m.length){if(w(e)){var O=e.name?": "+e.name:"";return t.stylize("[Function"+O+"]","special")}if(y(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(b(e))return t.stylize(Date.prototype.toString.call(e),"date");if(P(e))return a(e);if(d(E))return _=o(t,E),t.stylize("[String: "+_+"]","string");if(p(E))return _=o(t,E),t.stylize("[Number: "+_+"]","number");if(l(E))return _=o(t,E),t.stylize("[Boolean: "+_+"]","boolean")}var x="",L=!1,N=["{","}"];if(G(e)&&(L=!0,N=["[","]"]),w(e)){var j=e.name?": "+e.name:"";x=" [Function"+j+"]"}if(y(e)&&(x=" "+RegExp.prototype.toString.call(e)),b(e)&&(x=" "+Date.prototype.toUTCString.call(e)),P(e)&&(x=" "+a(e)),d(E)&&(_=o(t,E),x=" [String: "+_+"]"),p(E)&&(_=o(t,E),x=" [Number: "+_+"]"),l(E)&&(_=o(t,E),x=" [Boolean: "+_+"]"),0===m.length&&(!L||0===e.length))return N[0]+x+N[1];if(0>r)return y(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var z;return z=L?u(t,e,r,v,m):m.map(function(n){return c(t,e,r,v,n,L)}),t.seen.pop(),h(z,x,N)}function s(t,e){if(v(e))return t.stylize("undefined","undefined");if(d(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return p(e)?0===e&&0>1/e?t.stylize("-0","number"):t.stylize(""+e,"number"):l(e)?t.stylize(""+e,"boolean"):f(e)?t.stylize("null","null"):m(e)?t.stylize(e.toString(),"symbol"):void 0}function o(t,e){var n=t.stylize;t.stylize=r;var i=s(t,e);return t.stylize=n,i}function a(t){return"["+Error.prototype.toString.call(t)+"]"}function u(t,e,r,n,i){for(var s=[],o=0,a=e.length;a>o;++o)N(e,String(o))?s.push(c(t,e,r,n,String(o),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(c(t,e,r,n,i,!0))}),s}function c(t,e,r,n,s,o){var a,u,c;if(c=Object.getOwnPropertyDescriptor(e,s)||{value:e[s]},c.get?u=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(u=t.stylize("[Setter]","special")),N(n,s)||(a="["+s+"]"),u||(t.seen.indexOf(c.value)<0?(u=f(r)?i(t,c.value,null):i(t,c.value,r-1),u.indexOf("\n")>-1&&(u=o?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n"))):u=t.stylize("[Circular]","special")),v(a)){if(o&&s.match(/^\d+$/))return u;a=JSON.stringify(""+s),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'").replace(/\\\\/g,"\\"),a=t.stylize(a,"string"))}return a+": "+u}function h(t,e,r){var n=t.reduce(function(t,e){return t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function l(t){return"boolean"==typeof t}function f(t){return null===t}function g(t){return null==t}function p(t){return"number"==typeof t}function d(t){return"string"==typeof t}function m(t){return"symbol"==typeof t}function v(t){return void 0===t}function y(t){return _(t)&&"[object RegExp]"===O(t)}function _(t){return"object"==typeof t&&null!==t}function b(t){return _(t)&&"[object Date]"===O(t)}function P(t){return _(t)&&("[object Error]"===O(t)||t instanceof Error)}function w(t){return"function"==typeof t}function E(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function S(t){return t instanceof Buffer}function O(t){return Object.prototype.toString.call(t)}function x(t){return 10>t?"0"+t.toString(10):t.toString(10)}function L(){var t=new Date,e=[x(t.getHours()),x(t.getMinutes()),x(t.getSeconds())].join(":");return[t.getDate(),q[t.getMonth()],e].join(" ")}function N(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function j(){j.init.call(this)}function z(t){if(j.call(this),t instanceof M==!1)throw new Error("Invalid config");if(!t.dataProvider)throw new Error("You must specify a data provider");this.contexts={},this.config=t,this.dataProvider=this.config.dataProvider,this.name=this.config.name}function A(){j.call(this),this._filters=[],this.operatorsArray=Object.keys(this.operators).map(function(t){return this.operators[t]},this)}function D(t){j.call(this),this._filter=new A,this._sorting=new U,this._pagination=new I,this.resourceName=t||null}function I(){j.call(this),this.reset()}function U(){j.call(this),this._sorting=[]}function F(t){j.call(this);var e=F.createQuery();return this.name=t,this.data=null,this.error=null,this.query=e,e.on("update",function(t){this.emit("update")}.bind(this)),this}function C(){function t(){this.emit("update")}D.call(this);var e=t.bind(this);this._filter.on("update",e),this._sorting.on("update",e),this._pagination.on("update",e)}function J(){j.call(this)}function M(t){if(!t.name)throw new Error("Invalid resource name");if(t.dataProvider instanceof J==!1)throw new Error("Invalid data provider");B.extend(this,t)}var B={},Q={noDeprecation:!0,env:{NODE_DEBUG:1}},R={process:Q};B.isFloat=function(t){return t===Number(t)&&t%1!==0},B.missing=function(t){return function(){throw new Error("Method "+t+" not implemented")}},B.toArray=function(t){return Array.prototype.slice.apply(t)};var T=/%[sdj%]/g;B.format=function(e){if(!d(e)){for(var r=[],n=0;n<arguments.length;n++)r.push(t(arguments[n]));return r.join(" ")}for(var n=1,i=arguments,s=i.length,o=String(e).replace(T,function(t){if("%%"===t)return"%";if(n>=s)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return t}}),a=i[n];s>n;a=i[++n])o+=f(a)||!_(a)?" "+a:" "+t(a);return o},B.deprecate=function(t,e){function r(){if(!n){if(Q.throwDeprecation)throw new Error(e);Q.traceDeprecation?console.trace(e):console.error(e),n=!0}return t.apply(this,arguments)}if(v(R.process))return function(){return B.deprecate(t,e).apply(this,arguments)};if(Q.noDeprecation===!0)return t;var n=!1;return r};var k,V={};B.debuglog=function(t){if(v(k)&&(k=Q.env.NODE_DEBUG||""),t=t.toUpperCase(),!V[t])if(new RegExp("\\b"+t+"\\b","i").test(k)){var e=Q.pid;V[t]=function(){var r=B.format.apply(B,arguments);console.error("%s %d: %s",t,e,r)}}else V[t]=function(){};return V[t]},B.inspect=t,t.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},t.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",symbol:"green",date:"magenta",regexp:"red"};var G=B.isArray=Array.isArray;B.isBoolean=l,B.isNull=f,B.isNullOrUndefined=g,B.isNumber=p,B.isString=d,B.isSymbol=m,B.isUndefined=v,B.isRegExp=y,B.isObject=_,B.isDate=b,B.isError=P,B.isFunction=w,B.isPrimitive=E,B.isBuffer=S;var q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];B.log=function(){console.log("%s - %s",L(),B.format.apply(B,arguments))},B.inherits=function(t,e,r){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_(r)&&B.extend(t.prototype,r)},B._extend=function(t,e){if(!e||!_(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t},B.extend=B._extend,B.p=B.deprecate(function(){for(var t=0,e=arguments.length;e>t;++t)console.error(B.inspect(arguments[t]))},"util.p: Use console.error() instead"),B.print=B.deprecate(function(){for(var t=0,e=arguments.length;e>t;++t)Q.stdout.write(String(arguments[t]))},"util.print: Use console.log instead"),B.puts=B.deprecate(function(){for(var t=0,e=arguments.length;e>t;++t)Q.stdout.write(arguments[t]+"\n")},"util.puts: Use console.log instead"),B.debug=B.deprecate(function(t){Q.stderr.write("DEBUG: "+t+"\n")},"util.debug: Use console.error instead"),B.error=B.deprecate(function(t){for(var e=0,r=arguments.length;r>e;++e)Q.stderr.write(arguments[e]+"\n")},"util.error: Use console.error instead"),B.pump=B.deprecate(function(t,e,r){function n(t,e,n){r&&!i&&(r(t,e,n),i=!0)}var i=!1;t.addListener("data",function(r){e.write(r)===!1&&t.pause()}),e.addListener("drain",function(){t.resume()}),t.addListener("end",function(){e.end()}),t.addListener("close",function(){n()}),t.addListener("error",function(t){e.end(),n(t)}),e.addListener("error",function(e){t.destroy(),n(e)})},"util.pump(): Use readableStream.pipe() instead");var $;B._errnoException=function(t,e,r){v($)&&($=Q.binding("uv"));var n=$.errname(t),i=e+" "+n;r&&(i+=" "+r);var s=new Error(i);return s.code=n,s.errno=n,s.syscall=e,s},j.EventEmitter=j,j.usingDomains=!1,j.prototype.domain=void 0,j.prototype._events=void 0,j.prototype._maxListeners=void 0,j.defaultMaxListeners=10,j.init=function(){this.domain=null,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events={}),this._maxListeners=this._maxListeners||void 0},j.prototype.setMaxListeners=function(t){if(!B.isNumber(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},j.prototype.emit=function(t){var e,r,n,i,s,o;if(this._events||(this._events={}),"error"===t&&!this._events.error){if(e=arguments[1],!this.domain)throw e instanceof Error?e:Error('Uncaught, unspecified "error" event.');return e||(e=new Error('Uncaught, unspecified "error" event.')),e.domainEmitter=this,e.domain=this.domain,e.domainThrown=!1,this.domain.emit("error",e),!1}if(r=this._events[t],B.isUndefined(r))return!1;if(this.domain&&this!==Q&&this.domain.enter(),B.isFunction(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,i=new Array(n-1),s=1;n>s;s++)i[s-1]=arguments[s];r.apply(this,i)}else if(B.isObject(r)){for(n=arguments.length,i=new Array(n-1),s=1;n>s;s++)i[s-1]=arguments[s];for(o=r.slice(),n=o.length,s=0;n>s;s++)o[s].apply(this,i)}return this.domain&&this!==Q&&this.domain.exit(),!0},j.prototype.addListener=function(t,e){var r;if(!B.isFunction(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,B.isFunction(e.listener)?e.listener:e),this._events[t]?B.isObject(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,B.isObject(this._events[t])&&!this._events[t].warned){var r;r=B.isUndefined(this._maxListeners)?j.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d %s listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length,t),console.trace())}return this},j.prototype.on=j.prototype.addListener,j.prototype.once=function(t,e){function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}if(!B.isFunction(e))throw TypeError("listener must be a function");var n=!1;return r.listener=e,this.on(t,r),this},j.prototype.removeListener=function(t,e){var r,n,i,s;if(!B.isFunction(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],i=r.length,n=-1,r===e||B.isFunction(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(B.isObject(r)){for(s=i;s-->0;)if(r[s]===e||r[s].listener&&r[s].listener===e){n=s;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},j.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],B.isFunction(r))this.removeListener(t,r);else if(Array.isArray(r))for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},j.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?B.isFunction(this._events[t])?[this._events[t]]:this._events[t].slice():[]},j.listenerCount=function(t,e){var r;return r=t._events&&t._events[e]?B.isFunction(t._events[e])?1:t._events[e].length:0},B.inherits(z,j,{hasContext:function(t){return this.contexts[t]instanceof F},createContext:function(t){if(!this.hasContext(t)){var e=new F(t);e.on("update",function(){this.updateContext(e)}.bind(this)),this.contexts[t]=e}return this.getContext(t)},getContext:function(t){return this.contexts[t]},updateContext:function(t){var e=t.toJSON();return this.dataProvider.find(this.name,e).then(function(e){t.setData(e)},function(e){t.setError(e)}),this},find:function(t){if(t instanceof D==!1)throw new Error("Invalid query builder");var e=t.toJSON();return this.dataProvider.find(this.name,e)}}),A.create=function(t){var e=new A;return e.setState(t),e},B.inherits(A,j,{reset:function(){this._filters=[]},where:function(t,e,r){return 2===arguments.length&&(r=e,e=this.operators.EQ),this.hasOperator(e)?(this.addFilter(t,e,r),this):this},hasOperator:function(t){return this.operatorsArray.indexOf(t)>-1},remove:function(t){return t?(this._filters.forEach(function(e,r){e.name===t&&this._filters.splice(r,1)},this),this):this},addFilter:function(){var t,e=B.toArray(arguments);if(B.isArray(e[0])&&(e=e[0]),B.isObject(e[0])&&(t=e[0]),B.isUndefined(t)&&(t={name:e[0],operator:e[1],value:e[2]}),!t)return this;var r=this._filters.some(function(e){return e.name===t.name&&e.operator===t.operator});return r?this:(this._filters.push(t),this)},addFilters:function(t){if(!B.isArray(t))throw new Error("Must be an array");return t.forEach(this.addFilter,this),this},operators:{EQ:"=",LT:"<",LTE:"<=",GT:">",GTE:">=",IN:"in",ST:"^",END:"$",LK:"~"},setState:function(){return this.addFilter.apply(this,arguments)},toJSON:function(){return this._filters.slice()}}),B.inherits(D,j,{from:function(t){return this.resourceName=t,this},where:function(){return this._filter.where.apply(this._filter,arguments),this},orderBy:function(){return this._sorting.sort.apply(this._sorting,arguments),this},pagination:function(){return this._pagination},toJSON:function(){return{filters:this._filter.toJSON(),pagination:this._pagination.toJSON(),sorting:this._sorting.toJSON()}},reset:function(){return this._filter.reset(),this._sorting.reset(),this._pagination.reset(),this}}),B.extend(D,A.prototype.operators),B.inherits(I,j,{isValidPage:function(t){return t>0&&t<=this.totalPages},next:function(){return this.isValidPage(this.currentPage+1)?(this.setPage(this.currentPage+1),this):this},previous:function(){return this.isValidPage(this.currentPage-1)?(this.setPage(this.currentPage-1),this):this},setPage:function(t){this.currentPage;return this.currentPage=t,this.emit("update"),this},setState:function(t){var e=t.totalItems;if(0!==e&&!B.isUndefined(e)&&isNaN(e))throw new Error("Invalid total items property");return angular.extend(this,t),this.refresh(),this},refresh:function(){(this.currentPage<1||!this.isValidPage(this.currentPage))&&(this.currentPage=this.defaults.currentPage),this.itemsPerPage<1&&(this.itemsPerPage=Math.floor(this.defaults.itemsPerPage)),this.totalItems=this.totalItems||0,this.itemsPerPage=parseInt(this.itemsPerPage),(!this.totalPages||B.isFloat(this.totalPages))&&(this.totalPages=Math.round(this.totalItems/this.itemsPerPage)),this.totalPagesArray=[];for(var t=0;t<this.totalPages.length;t++)this.totalPagesArray.push(t+1)},reset:function(){return this.setState({currentPage:0,itemsPerPage:0,totalItems:0,totalPages:0}),this},last:function(){return this.isValidPage(this.totalPages)?(this.setPage(this.totalPages),this):this},first:function(){return this.currentPage?this.setPage(1):this},toJSON:function(){var t={},e=["itemsPerPage","currentPage","count"];return angular.forEach(e,function(e){angular.isDefined(this[e])&&(t[e]=this[e])},this),t},defaults:{itemsPerPage:4,currentPage:1,totalItems:0}}),B.inherits(U,j,{directions:{ASC:"asc",DESC:"desc"},sort:function(t,e){1===arguments.length&&(e=this.directions.ASC);var r={name:t,direction:e};return this.addSorting(r),this},hasSorting:function(t){return this._sorting.some(function(e){return e.name===t})},addSorting:function(t){return this.hasSorting(t.name)&&this._sorting.push(t),this},reset:function(){return this._sorting=[],this},toJSON:function(){return this._sorting.slice()}}),F.createQuery=function(){return new C},B.inherits(F,j,{INVALID_RESPONSE:"INVALID_RESPONSE",getData:function(){return this.data},setData:function(t){if(B.isUndefined(t)||!B.isObject(t))return this.setError(this.INVALID_RESPONSE),this;var e=t.meta;if(e){var r=this.query.pagination();r.setState({totalItems:e.totalItems,currentPage:e.currentPage,itemsPerPage:e.itemsPerPage})}return this.data=t.data||null,this.error=null,this},createQuery:function(){return F.createQuery().from(this.name)},pagination:function(){return this.query.pagination()},reset:function(){return this.query.reset(),this},update:function(){return this.triggerUpdate(this),this},triggerUpdate:function(){return this.emit("update")},setError:function(t){},toJSON:function(){return this.query.toJSON()}}),B.inherits(C,D),B.inherits(J,j,{find:B.missing("find"),findOne:B.missing("find")}),angular.module("repository",[]).factory("Repository",function(){return z}).factory("DataProvider",function(){return J}).factory("RepositoryConfig",function(){return M}).factory("QueryBuilder",function(){return D}).factory("QueryFilter",function(){return A}).factory("QueryPagination",function(){return I}).factory("QuerySorting",function(){return U}).factory("Context",function(){return F}).factory("ContextQueryBuilder",function(){return C})}();